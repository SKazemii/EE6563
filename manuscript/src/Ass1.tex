\documentclass[12pt]{article}
\usepackage{url}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\graphicspath{{images/}}
\usepackage{parskip}
\usepackage{fancyhdr}
\usepackage{vmargin}
\usepackage{booktabs}
\usepackage{subcaption}
\usepackage{listings}
\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}
\usepackage[section]{placeins}
\usepackage{float}
\setmarginsrb{3 cm}{2.5 cm}{3 cm}{2.5 cm}{1 cm}{1.5 cm}{1 cm}{1.5 cm}

\title{Assignment \#1}								% Title
\author{Saeed Kazemi}								% Author
\date{\today}											% Date

\makeatletter
\let\thetitle\@title
\let\theauthor\@author
\let\thedate\@date
\makeatother

\pagestyle{fancy}
\fancyhf{}
\rhead{\theauthor}
\lhead{\thetitle}
\cfoot{\thepage}

\usepackage{tikz}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;} 


\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{titlepage}
	\centering
    \vspace*{0.4 cm}
    \includegraphics[scale = 0.5]{figures/unb.jpg}\\[1.0 cm]	% University Logo
    \textsc{\LARGE \newline\newline University of New Brunswick}\\[1.8 cm]	% University Name
	\textsc{\Large Time Series Analysis\\(EE 6563)}\\[0.5 cm]				% Course Code
	\rule{\linewidth}{0.2 mm} \\[0.4 cm]
	{ \huge \bfseries \thetitle}\\
	\rule{\linewidth}{0.2 mm} \\[1.5 cm]
	
	\begin{minipage}{0.5\textwidth}
		\begin{flushleft} \large
			\emph{Professor:}\\
			Erik Scheme\\
            Electrical and Computer Engineering\\
			\end{flushleft}
			\end{minipage}~
			\begin{minipage}{0.5\textwidth}
            
			\begin{flushright} \large
			\emph{Author:} \\
			Saeed Kazemi\\ (3713280)\\

		\end{flushright}
        
	\end{minipage}\\[1 cm]
	
	
    \thedate
    
    
    
	
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\tableofcontents
\pagebreak

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%==========================================================
\begin{enumerate}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% Question 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\item \textbf{For each dataset, visualize the raw signals, identify any trends, seasonality, and/or other components, and try to remove them. Remember that you are not limited to the tools shown in the tutorial and should explore the various concepts discussed in class. You do not need to explain the theory behind the approaches, but you should provide justification for their use, and discussion of their results.}


Figure \ref{fig:Ass1_D1_raw_signal} to figure \ref{fig:Ass1_D2_raw_signal} indicate the raw signal of both data sets. Furthermore, figure \ref{fig:Ass1_D1_raw_signal_1986} to figure \ref{fig:Ass1_D2_raw_signal_1990} illustrate a period of two datasets. 

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_raw_signal.png}
    \end{minipage}
    \caption{Visualizing the raw signals of the first dataset.}
    \label{fig:Ass1_D1_raw_signal}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_raw_signal.png}
    \end{minipage}
    \caption{Visualizing the raw signals of the second dataset.}
    \label{fig:Ass1_D2_raw_signal}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_raw_signal_1986.png}
    \end{minipage}
    \caption{Visualizing the raw signals of the first dataset in 1986.}
    \label{fig:Ass1_D1_raw_signal_1986}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_raw_signal_1990.png}
    \end{minipage}
    \caption{Visualizing the raw signals of the first dataset in 1990.}
    \label{fig:Ass1_D1_raw_signal_1990}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_raw_signal_1990.png}
    \end{minipage}
    \caption{Visualizing the raw signals of the second dataset in 1990.}
    \label{fig:Ass1_D2_raw_signal_1990}
\end{figure}

For intuition, Table \ref{tab:Ass1_D1_raw_signal} to table \ref{tab:Ass1_D2_raw_signal_summary_statistics} show the top raw of two datasets along with their summary of description.


\begin{table}[H]
 \centering
\caption{The top row of the raw signal of the first dataset (daily temp).
{\label{tab:Ass1_D1_raw_signal}}}
\input{tables/Ass1/Ass1_D1_raw_signal.tex}
\end{table}

\begin{table}[H]
 \centering
\caption{The description of the first dataset.
{\label{tab:Ass1_D1_raw_signal_summary_statistics}}}
\input{tables/Ass1/Ass1_D1_raw_signal_summary_statistics.tex}
\end{table}

\begin{table}[H]
 \centering
\caption{The top row of the raw signal of the second dataset.
{\label{tab:Ass1_D2_raw_signal}}}
\input{tables/Ass1/Ass1_D2_raw_signal.tex}
\end{table}

\begin{table}[H]
 \centering
\caption{The description of the second dataset.
{\label{tab:Ass1_D2_raw_signal_summary_statistics}}}
\input{tables/Ass1/Ass1_D2_raw_signal_summary_statistics.tex}
\end{table}

For decomposing the data the below methods were used:
    \begin{enumerate}
    \item Seasonal\_decompose (Figure
        \ref{fig:Ass1_D1_seasonal_decompose} and \ref{fig:Ass1_D2_seasonal_decompose})
        
    \item STL (Figure
        \ref{fig:Ass1_D1_STL} and \ref{fig:Ass1_D2_STL})
        
    \item Linear Regression method (Figure
        \ref{fig:Ass1_D1_LinearRegression_diff} and \ref{fig:Ass1_D2_LinearRegression_diff})
        
    \item Difference method (Figure
        \ref{fig:Ass1_D1_one_diff} and \ref{fig:Ass1_D2_one_diff})
        
    \item fitting a polynomial (Figure
        \ref{fig:Ass1_D1_fiting_polynomial} and \ref{fig:Ass1_D2_fiting_polynomial})

    \end{enumerate}
Some of these methods extracted only one component while others like STL and Seasonal\_decompose provided all three components. Table \ref{tab:Ass1_comparing_methods} compares these methods together.

\begin{table}[H]
\centering
\caption{Comparing the implemented methods.
\label{tab:Ass1_comparing_methods}}
\input{tables/Ass1/Ass1_comparing_methods.tex}
\end{table}




\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_seasonal_decompose.png}
    \end{minipage}
    \caption{Decomposition of the first dataset by seasonal\_decompose method}
    \label{fig:Ass1_D1_seasonal_decompose}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_seasonal_decompose.png}
    \end{minipage}
    \caption{Decomposition of the second dataset by seasonal\_decompose method}
    \label{fig:Ass1_D2_seasonal_decompose}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_STL.png}
    \end{minipage}
    \caption{Decomposition of the first dataset by STL method}
    \label{fig:Ass1_D1_STL}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_STL.png}
    \end{minipage}
    \caption{Decomposition of the second dataset by STL method}
    \label{fig:Ass1_D2_STL}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_LinearRegression_diff.png}
    \end{minipage}
    \caption{Decomposition of the first dataset by LinearRegression and difference method.}
    \label{fig:Ass1_D1_LinearRegression_diff}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_LinearRegression_diff.png}
    \end{minipage}
    \caption{Decomposition of the second dataset by LinearRegression and difference method.}
    \label{fig:Ass1_D2_LinearRegression_diff}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_one_diff.png}
    \end{minipage}
    \caption{Detrending of the first dataset by difference method.}
    \label{fig:Ass1_D1_one_diff}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_one_diff.png}
    \end{minipage}
    \caption{Detrending of the second dataset by difference method.}
    \label{fig:Ass1_D2_one_diff}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D1_fiting_polynomial.png}
    \end{minipage}
    \caption{Seasonal component of the first dataset by fitting a polynomial.}
    \label{fig:Ass1_D1_fiting_polynomial}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass1/Ass1_D2_fiting_polynomial.png}
    \end{minipage}
    \caption{Seasonal component of the second dataset by fitting a polynomial.}
    \label{fig:Ass1_D2_fiting_polynomial}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% Question 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\item \textbf{For each dataset, examine the stationarity of the residuals using the ACF and PACF functions, Lag Plots, and/or other approaches. Show your results and provide commentary about your observations.}

You see how ACF is declining in amplitude exponentially, while PACF cuts off after lag 1. This may suggest that you're dealing with AR(1) process. How do I know this? If you derive the ACF and PACF assuming that your process is AR(1), which includes constant variance of errors, then you'd come up with a similar shaped curves. Hence, if your underlying series are not stationary, you're breaking the assumptions that are base for the heuristics that I mentioned about ACF/PACF. It's pointless to apply these on non-stationary series, since you can't make any conclusions about the lag structure anymore.

The p-value is obtained is greater than significance level of 0.05 and the ADF statistic is higher than any of the critical values. Clearly, there is no reason to reject the null hypothesis. So, the time series is in fact non-stationary.

The p-value is very less than the significance level of 0.05 and hence we can reject the null hypothesis and take that the series is stationary.

Case 1: Both tests conclude that the series is not stationary - The series is not stationary
Case 2: Both tests conclude that the series is stationary - The series is stationary
Case 3: KPSS indicates stationarity and ADF indicates non-stationarity - The series is trend stationary. Trend needs to be removed to make series strict stationary. The detrended series is checked for stationarity.
Case 4: KPSS indicates non-stationarity and ADF indicates stationarity - The series is difference stationary. Differencing is to be used to make series stationary. The differenced series is checked for stationarity.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% Question 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\item \textbf{Try modeling the residuals as an AR process. Use the tools at your disposal to decide on an appropriate order and analyse the results. What is the impact of selecting different orders on the remaining residuals?}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% Question 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\item \textbf{Summarize your findings and observations briefly in a final discussion. Submit both the developed code and your document to the Assignment 1 folder on D2L.}






\end{enumerate}







\newpage
\section{Appendix (codes)}
\subsection{The script of Lab-1}

\begin{lstlisting}
%% Lab 1: Discrete-Time Frequency
% 
% Author: Maryhelen Stevenson
%
%% Explanation of the function ct_dt(.)
%
% The file ct_dt.m was supplied for use in this lab; a listing of the file
% is included in Appendix 1. The file defines a matlab function
% ct_dt(A,f0,PHI,fs,nc,ifig) which can be used to plot nc cycles
% of a continuous-time cosine with amplitude A, frequency f0, and phase
% PHI.  It also superimposes the values of the discrete-time sinusoid that
% would result from sampling the continuous-time sinusoid at a rate of fs
% samples per second.  The function returns a vector of time
% instances at which the values of the continuous-time sinusoid were
% evaluated to generate the continuous-time plot.
% 
% 
% An example to illustrate the usage of ct_dt(.) follows: 
%
close all
A = 2; % amplitude of continuous-time cosine
f0 = 0.5; % frequency (in units of Hz.) of continuous-time cosine
PHI = -pi/4; % phase (in units of radians) of continuous-time cosine
fs = 10; % sampling rate to be used (units of samples/second)
nc = 5; % number of cycles of continuous-time cosine to be plotted
ifig = 1; % optional figure number to use in the title of the figure
% the function returns the time vector used to plot the c.t. signal
t = ct_dt(A,f0,PHI,fs,nc,ifig); 

%%
% _Discussion of Figure 1_
% In accordance with the usage of ct_dt, we note that Figure 1,
% contains 5 cycles of the continuous-time cosine, $$x_a(t)$,
% where $$x_a(t)=2\cos(2\pi(0.5)t - \pi/4)$.  It also superimposes the 
% discrete-time sinusoid x[n] = xa(n/10).  The values of n are not shown
% but could be added in by hand.  Note that t=0 corresponds to n=0; whereas
% t=1 corresponds to n=10.
% etc.
% 
%% Exercise 1
%  
% Let x_a(t) = 3 sin(2 pi 50 t) = 3 cos (2 pi 50 t - pi/2)
% 
% Define x[n] = x_a(n/fs)
%
% a) Figure 2 shows a plot of xa(t) and x[n] for the case when fs=200
% samples/second.  It was produced using the code below.
% 
%  include the necessary code
close all
A = 3; 
f0 = 50; 
PHI = -pi/2; 
fs = 200; 
nc = 6;
ifig = 2; 


t = ct_dt(A,f0,PHI,fs,nc,ifig); 


%%
% _Discussion of Figure 2_
%
% include discussion here.  Your discussion should include answers to all
% questions posed in the lab manual.  Please use complete sentences.  Keep
% in mind that a reader should not have to have a copy of the lab manual to
% make sense of your discussion.
%%
% b) Figure 3 shows a plot of xa(t) and x[n] for the case when fs=120
% samples/second. It was produced using the code below.
% 
%  include the necessary code
fs = 120; 
ifig = 3; 


t = ct_dt(A,f0,PHI,fs,nc,ifig); 
%%
% _Discussion of Figure 3_
%
% include discussion here
%%
% c) Figure 4 shows a plot of xa(t) and x[n] for the case when fs=40
% samples/second. It was produced using the code below.
% 
%  include the necessary code 
fs = 40; 
ifig = 4; 


t = ct_dt(A,f0,PHI,fs,nc,ifig);
%%
% _Discussion of Figure 4_
%
% include discussion here.  
%
%%
% d) ...
%
%% Exercise 2
%
% 

close all
A = 6; 
f0 = 50; 
PHI = -pi/3; 
fs = 100; 
nc = 2;
ifig = 21; 


t = ct_dt(A,f0,PHI,fs,nc,ifig); 


A = 3; 
f0 = 50; 
PHI = 0; 
fs = 100; 
nc = 2;
ifig = 22; 


t = ct_dt(A,f0,PHI,fs,nc,ifig);


A = 6; 
f0 = 50; 
PHI = -pi/3; 
fs = 100; 
nc = 2;
ifig = 23; 


t = ct_dt(A,f0,PHI,fs,nc,ifig); 
y = 3*cos(2*pi*50*t);
plot(t,y,'*')
legend('x(t)','x[n]','y(t)')
%% Exercise 3
%
% 



close all
A = 1; 
f0 = 50; 
PHI = -pi/2; 
fs = 80; 
nc = 5;
ifig = 31; 


t = ct_dt(A,f0,PHI,fs,nc,ifig); 


y = cos(2*pi*30*t + pi/2);

plot(t,y,'*')
legend('x(t)','x[n]','y(t)')


%% Exercise 4
%
%
close all
A = 1; 
f0 = 60; 
PHI = 0; 
fs = 50; 
nc = 12;
ifig = 41; 


t = ct_dt(A,f0,PHI,fs,nc,ifig); 

y = cos(2*pi*10*t);

plot(t,y,'*')
legend('x(t)','x[n]','y(t)')

%% Appendix 1: Listing of the file ct_dt.m
%
%     Please include a listing of the function here, complete with any 
%     modifications that you may have made.
%
%     function t = ct_dt(A,f0,PHI,fs,nc, ifig)
%     %A 	    amplitude of cosine;
%     %f0 	CT frequency of cosine (cycles/sec);
%     %PHI 	phase of cosine (radians);
%     %fs	    sampling frequency (samples/sec.)
%     %nc 	number of CT cycles to be displayed
%     %ifig   optional Figure number to use in the title of the plot
%
%     ...

\end{lstlisting}
\subsection{The function of ct\_dt}
\begin{lstlisting}
function t = ct_dt(A,f0,PHI,fs,nc, ifig)
%A 	    amplitude of cosine;
%f0 	CT frequency of cosine (cycles/sec);
%PHI 	phase of cosine (radians);
%fs	    sampling frequency (samples/sec.)
%nc 	number of CT cycles to be displayed
%ifig   option Figure number to use in the title of the plot
%t      time vector used to plot CT cosine
if (nargin < 5 | nargin > 6)
    error('in call to ct_dt: there should be 5 arguments')
end
if (A < 0 )
    error(['in call to ct_dt: Amplitude of cosine, A,' ...
        'should not be negative'])
end
if (fs<0)
    error(['in call to ct_dt: the sampling frequency,'...
           ' fs,should be positive'])
end
if (nc<0)
    error('in call to ct_dt: nc should be positive')
end
if (exist('ifig'))
    pFig = ['Fig. ', num2str(ifig),':  '];
else
    pFig = [''];
end
    

figure, clf      
Ts=1/fs; %time between samples
Tp=1/abs(f0);  %period of CT cosine (sec/cycle)
F0 = f0/fs; %DT frequency (cycles/sample)
%DT plot will display samples n=0 to n=nmax
nmax = nc/abs(F0); 
%CT plot will display t=0 to t=tmax
tmax = nmax * Ts; 
% define t vector for CT plots to:
%  have a length greater than or equal to 200
%  with every kth element corresponding to a sampling instant
k = ceil(200/nmax);
t=0:Ts/k:tmax; 
xa = A*cos(2*pi*f0*t + PHI);
plot(t,xa);
hold on
n=0:nmax;
nTs = n*Ts;
xn = A*cos(2*pi*F0*n + PHI);
stem(nTs,xn);

p0=['x_a(t)=A cos(2\pi f_0 t), '];
p1=[' A='];
p2=[', f0='];
p3=[', PHI='];
p4=[', fs='];
p5=[', nc='];
p6=[', User='];
name=getenv('USER'); % gets the users login id
title( [pFig p0 p1 num2str(A) p2 num2str(f0) p3 num2str(PHI) ...
         p4 num2str(fs) p5 num2str(nc) p6 name ] )
xlabel('t (seconds), n')

\end{lstlisting}

\end{document}